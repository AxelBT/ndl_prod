<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>Profil ‚Äî R√©sistance NIRD</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        :root {
            --nird-green: #10b981;
            --nird-green-dark: #059669;
            --nird-blue: #3b82f6;
            --nird-purple: #8b5cf6;
            --nird-amber: #f59e0b;
            --nird-red: #ef4444;
        }
        
        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            min-height: 100vh;
        }
        
        .profile-header {
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
        }
        
        .header-etablissement {
            background: linear-gradient(135deg, var(--nird-green) 0%, var(--nird-green-dark) 100%);
        }
        
        .header-collectivite {
            background: linear-gradient(135deg, var(--nird-blue) 0%, #2563eb 100%);
        }
        
        .header-individu {
            background: linear-gradient(135deg, var(--nird-purple) 0%, #7c3aed 100%);
        }
        
        .role-selector {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .role-option {
            transition: all 0.3s ease;
        }
        
        .role-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .role-option.active {
            border-width: 2px;
            transform: scale(1.05);
        }
        
        .mission-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .mission-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        
        .mission-card.etablissement::before {
            background: var(--nird-green);
        }
        
        .mission-card.collectivite::before {
            background: var(--nird-blue);
        }
        
        .mission-card.individu::before {
            background: var(--nird-purple);
        }
        
        .mission-card:hover::before {
            transform: scaleY(1);
        }
        
        .mission-card:hover {
            transform: translateX(4px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .badge {
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }
        
        .badge:hover {
            transform: translateY(-8px) rotateX(10deg);
        }
        
        .badge-locked {
            filter: grayscale(1) opacity(0.6);
        }
        
        .badge-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: #e5e7eb;
            border-radius: 0 0 8px 8px;
            overflow: hidden;
        }
        
        .badge-progress-fill {
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .progress-ring {
            transition: stroke-dashoffset 0.5s ease;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        
        .role-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            transition: all 0.3s ease;
        }
        
        .role-icon.etablissement {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(5, 150, 105, 0.1));
            border: 2px solid rgba(16, 185, 129, 0.3);
        }
        
        .role-icon.collectivite {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(37, 99, 235, 0.1));
            border: 2px solid rgba(59, 130, 246, 0.3);
        }
        
        .role-icon.individu {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(124, 58, 237, 0.1));
            border: 2px solid rgba(139, 92, 246, 0.3);
        }
        
        .stats-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        .link-card {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .link-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.1), transparent);
            transition: left 0.6s;
        }
        
        .link-card:hover::before {
            left: 100%;
        }
        
        .impact-meter {
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(90deg, #ef4444, #f59e0b, #10b981);
            position: relative;
        }
        
        .impact-marker {
            position: absolute;
            top: -5px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            transform: translateX(-50%);
            transition: left 0.5s ease;
        }
        
        @media (max-width: 768px) {
            .role-icon {
                width: 60px;
                height: 60px;
                font-size: 2rem;
            }
        }
    </style>
</head>

<body>
  
    <!-- En-t√™te du profil avec s√©lecteur de r√¥le -->
    <header class="profile-header header-etablissement text-white py-8 md:py-12 px-6" id="profileHeader">
        <div class="max-w-6xl mx-auto relative">
            <!-- S√©lecteur de r√¥le -->
            <div class="role-selector rounded-xl p-4 mb-8">
                <p class="text-white/80 mb-3 font-medium"><i class="fas fa-user-tag mr-2"></i>Votre r√¥le actuel :</p>
                <div class="flex flex-wrap gap-3">
                    <button class="role-option active flex items-center gap-3 px-4 py-3 rounded-lg bg-white/20 border-2 border-white/30"
                            data-role="etablissement" onclick="changeRole('etablissement')">
                        <i class="fas fa-school"></i>
                        <span>√âtablissement Scolaire</span>
                    </button>
                    <button class="role-option flex items-center gap-3 px-4 py-3 rounded-lg bg-white/10 border border-white/20"
                            data-role="collectivite" onclick="changeRole('collectivite')">
                        <i class="fas fa-landmark"></i>
                        <span>Collectivit√©</span>
                    </button>
                    <button class="role-option flex items-center gap-3 px-4 py-3 rounded-lg bg-white/10 border border-white/20"
                            data-role="individu" onclick="changeRole('individu')">
                        <i class="fas fa-user-graduate"></i>
                        <span>Individu / Enseignant</span>
                    </button>
                </div>
            </div>
            
            <!-- Informations du profil -->
            <div class="flex flex-col md:flex-row items-center justify-between gap-8">
                <div class="text-center md:text-left">
                    <div class="flex items-center justify-center md:justify-start gap-4 mb-6">
                        <div class="role-icon etablissement" id="roleIcon">
                            <i class="fas fa-school text-green-600"></i>
                        </div>
                        <div>
                            <h1 class="text-3xl md:text-4xl font-bold" id="welcomeTitle">Bienvenue R√©sistant</h1>
                            <p class="text-xl md:text-2xl text-white/90 font-semibold mt-2" id="roleTitle">√âtablissement Scolaire</p>
                        </div>
                    </div>
                    
                    <p class="text-lg text-white/90 max-w-2xl" id="roleDescription">
                        üéì Vous guidez √©l√®ves et √©quipes vers un num√©rique inclusif, souverain et durable.
                        <span class="block mt-2 text-white/80">Progression globale : <span id="globalProgress">45</span>%</span>
                    </p>
                </div>
                
                <!-- Progression circulaire -->
                <div class="relative">
                    <div class="w-32 h-32 relative">
                        <svg class="w-full h-full" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="45" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="8"/>
                            <circle id="progressCircle" class="progress-ring" cx="50" cy="50" r="45" fill="none" stroke="white" stroke-width="8" stroke-dasharray="283" stroke-dashoffset="155" stroke-linecap="round"/>
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="text-3xl font-bold text-white" id="progressText">45%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Contenu principal -->
    <main class="max-w-6xl mx-auto py-12 px-6">
        <!-- Section Stats dynamique -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12" id="statsContainer">
            <!-- Les statistiques seront mises √† jour dynamiquement -->
        </div>

        <!-- Section Missions dynamique -->
        <section class="mb-16">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3">
                    <i class="fas fa-bullseye text-green-600"></i>
                    <span id="missionsTitle">Missions cl√©s pour √©tablissements</span>
                </h2>
                <div class="bg-green-50 text-green-700 px-4 py-2 rounded-full font-medium" id="missionsStatus">
                    <i class="fas fa-fire mr-2"></i>
                    <span id="activeMissions">3</span> objectifs en cours
                </div>
            </div>
            
            <div class="space-y-4" id="missionsContainer">
                <!-- Les missions seront charg√©es dynamiquement -->
            </div>
            
            <div class="mt-8 text-center">
                <button class="px-6 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors" id="viewAllMissions">
                    <i class="fas fa-plus mr-2"></i>
                    Voir toutes les missions
                </button>
            </div>
        </section>

        <!-- Section Badges -->
        <section class="mb-16">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3">
                    <i class="fas fa-medal text-amber-500"></i>
                    Badges NIRD
                    <span class="text-sm font-normal text-gray-500" id="badgesCount">(2/12)</span>
                </h2>
                <div class="text-sm text-gray-600">
                    <i class="fas fa-info-circle mr-2"></i>
                    <span id="badgesInfo">Les badges sont adapt√©s √† votre r√¥le</span>
                </div>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="badgesContainer">
                <!-- Les badges seront charg√©s dynamiquement -->
            </div>
            
            <div class="mt-8 text-center">
                <p class="text-gray-600 mb-4" id="badgesHint">
                    <i class="fas fa-lightbulb mr-2 text-amber-500"></i>
                    Compl√©tez les missions pour d√©bloquer de nouveaux badges !
                </p>
            </div>
        </section>

        <!-- Section Liens dynamique -->
        <section>
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                <i class="fas fa-link text-blue-500"></i>
                <span id="linksTitle">Ressources pour √©tablissements</span>
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="linksContainer">
                <!-- Les liens seront charg√©s dynamiquement -->
            </div>
        </section>
    </main>

    <script>
        // Donn√©es par r√¥le
        const rolesData = {
            etablissement: {
                title: "√âtablissement Scolaire",
                icon: "fa-school",
                color: "green",
                description: "üéì Vous guidez √©l√®ves et √©quipes vers un num√©rique inclusif, souverain et durable.",
                stats: {
                    missions: "3/8",
                    badges: "2/12",
                    impact: "120kg CO¬≤"
                },
                missions: [
                    {
                        title: "Migration vers Linux",
                        description: "Installer une distribution Linux sur au moins 10 postes de l'√©tablissement.",
                        impact: "√©lev√©",
                        time: "15 jours",
                        points: 150,
                        completed: true
                    },
                    {
                        title: "Atelier de sensibilisation",
                        description: "Organiser un atelier sur la sobri√©t√© num√©rique pour les √©l√®ves.",
                        impact: "collectif",
                        time: "7 jours",
                        points: 100,
                        completed: false
                    },
                    {
                        title: "Cr√©ation d'un club informatique",
                        description: "Mettre en place un club d√©di√© au reconditionnement et au libre.",
                        impact: "p√©dagogique",
                        time: "30 jours",
                        points: 200,
                        completed: true
                    }
                ],
                badges: [
                    { id: "pingouin", name: "Pingouin Initi√©", description: "Premi√®re installation Linux r√©ussie", icon: "üêß", progress: 100, unlocked: true },
                    { id: "reconditionneur", name: "Reconditionneur", description: "5 appareils donn√©s une seconde vie", icon: "‚ôªÔ∏è", progress: 60, unlocked: true },
                    { id: "pedagogue", name: "P√©dagogue du Libre", description: "Former 20 √©l√®ves au logiciel libre", icon: "üë®‚Äçüè´", progress: 30, unlocked: false },
                    { id: "ecoresponsable", name: "√âco-responsable", description: "R√©duire de 40% la consommation num√©rique", icon: "üå±", progress: 45, unlocked: false }
                ],
                links: [
                    { title: "Forum Tchap √âtablissements", icon: "fa-comments", description: "√âchangez avec d'autres √©tablissements", color: "blue" },
                    { title: "Ressources P√©dagogiques", icon: "fa-book-open", description: "Supports de cours et activit√©s", color: "green" },
                    { title: "Guide Migration Linux", icon: "fa-download", description: "Proc√©dure compl√®te pas √† pas", color: "purple" },
                    { title: "Kit Communication", icon: "fa-bullhorn", description: "Mod√®les pour sensibiliser", color: "amber" }
                ]
            },
            
            collectivite: {
                title: "Collectivit√©",
                icon: "fa-landmark",
                color: "blue",
                description: "üèõÔ∏è Vous pilotez la transition num√©rique √©cologique de votre territoire.",
                stats: {
                    missions: "5/10",
                    badges: "4/10",
                    impact: "850kg CO¬≤"
                },
                missions: [
                    {
                        title: "Strat√©gie territoriale",
                        description: "√âlaborer un plan de transition num√©rique pour les services publics.",
                        impact: "strat√©gique",
                        time: "90 jours",
                        points: 300,
                        completed: true
                    },
                    {
                        title: "Centre de reconditionnement",
                        description: "Cr√©er un centre local de reconditionnement d'√©quipements.",
                        impact: "√©conomique",
                        time: "60 jours",
                        points: 250,
                        completed: true
                    },
                    {
                        title: "Formation des agents",
                        description: "Former 50 agents aux outils libres et √† la sobri√©t√© num√©rique.",
                        impact: "collectif",
                        time: "45 jours",
                        points: 200,
                        completed: false
                    }
                ],
                badges: [
                    { id: "stratege", name: "Strat√®ge Territorial", description: "Plan de transition adopt√©", icon: "üó∫Ô∏è", progress: 100, unlocked: true },
                    { id: "economie", name: "√âconomie Circulaire", description: "Centre de reconditionnement actif", icon: "‚ôªÔ∏è", progress: 80, unlocked: true },
                    { id: "formation", name: "Formateur Public", description: "50 agents form√©s", icon: "üë®‚Äçüíº", progress: 40, unlocked: false },
                    { id: "influence", name: "Influenceur Territorial", description: "5 communes accompagn√©es", icon: "ü§ù", progress: 20, unlocked: false }
                ],
                links: [
                    { title: "R√©seau Collectivit√©s", icon: "fa-network-wired", description: "√âchanges entre territoires", color: "blue" },
                    { title: "Cahier des Charges", icon: "fa-file-contract", description: "Mod√®les d'appels d'offres", color: "green" },
                    { title: "Indicateurs de Suivi", icon: "fa-chart-line", description: "Tableaux de bord d'impact", color: "purple" },
                    { title: "Support Juridique", icon: "fa-balance-scale", description: "Aspect l√©gal et r√©glementaire", color: "amber" }
                ]
            },
            
            individu: {
                title: "Individu / Enseignant",
                icon: "fa-user-graduate",
                color: "purple",
                description: "üë§ Chaque geste compte. Vous √™tes l'acteur direct du libre et de la sobri√©t√© num√©rique.",
                stats: {
                    missions: "7/12",
                    badges: "6/15",
                    impact: "35kg CO¬≤"
                },
                missions: [
                    {
                        title: "Migration personnelle",
                        description: "Passer enti√®rement √† Linux sur votre ordinateur principal.",
                        impact: "personnel",
                        time: "7 jours",
                        points: 100,
                        completed: true
                    },
                    {
                        title: "Protection des donn√©es",
                        description: "Migrer 5 services vers des alternatives respectueuses.",
                        impact: "privacy",
                        time: "14 jours",
                        points: 150,
                        completed: true
                    },
                    {
                        title: "Sensibilisation proche",
                        description: "Aider 3 personnes de votre entourage √† migrer.",
                        impact: "social",
                        time: "30 jours",
                        points: 200,
                        completed: false
                    }
                ],
                badges: [
                    { id: "libriste", name: "Libriste Confirm√©", description: "Usage quotidien des logiciels libres", icon: "üêß", progress: 100, unlocked: true },
                    { id: "privacy", name: "Gardien de la Vie Priv√©e", description: "Protection optimale des donn√©es", icon: "üõ°Ô∏è", progress: 80, unlocked: true },
                    { id: "mentor", name: "Mentor Num√©rique", description: "5 personnes accompagn√©es", icon: "üë®‚Äçüè´", progress: 60, unlocked: true },
                    { id: "expert", name: "Expert NIRD", description: "Ma√Ætrise de 10 outils libres", icon: "üåü", progress: 40, unlocked: false }
                ],
                links: [
                    { title: "Communaut√© Individus", icon: "fa-users", description: "Rencontrez d'autres r√©sistants", color: "blue" },
                    { title: "Formations en Ligne", icon: "fa-graduation-cap", description: "Cours et tutoriels gratuits", color: "green" },
                    { title: "Outils Personnels", icon: "fa-tools", description: "Logiciels et configurations", color: "purple" },
                    { title: "Blog NIRD", icon: "fa-blog", description: "T√©moignages et actualit√©s", color: "amber" }
                ]
            }
        };

        // R√¥le courant
        let currentRole = 'etablissement';

        // Changer de r√¥le
        function changeRole(role) {
            currentRole = role;
            const data = rolesData[role];
            
            // Mettre √† jour l'en-t√™te
            document.getElementById('profileHeader').className = `profile-header header-${role} text-white py-8 md:py-12 px-6`;
            document.getElementById('roleIcon').className = `role-icon ${role}`;
            document.getElementById('roleIcon').innerHTML = `<i class="fas ${data.icon} text-${data.color}-600"></i>`;
            document.getElementById('roleTitle').textContent = data.title;
            document.getElementById('roleDescription').innerHTML = `${data.description} <span class="block mt-2 text-white/80">Progression globale : <span id="globalProgress">${getProgress(role)}</span>%</span>`;
            
            // Mettre √† jour les boutons de s√©lection
            document.querySelectorAll('.role-option').forEach(btn => {
                if (btn.getAttribute('data-role') === role) {
                    btn.classList.add('active', 'bg-white/20', 'border-white/30', 'border-2');
                    btn.classList.remove('bg-white/10', 'border-white/20');
                } else {
                    btn.classList.remove('active', 'bg-white/20', 'border-white/30', 'border-2');
                    btn.classList.add('bg-white/10', 'border-white/20');
                }
            });
            
            // Mettre √† jour les stats
            updateStats(role);
            
            // Mettre √† jour les missions
            updateMissions(role);
            
            // Mettre √† jour les badges
            updateBadges(role);
            
            // Mettre √† jour les liens
            updateLinks(role);
            
            // Mettre √† jour la progression
            updateProgress(role);
        }

        // Calculer la progression
        function getProgress(role) {
            const data = rolesData[role];
            const completed = data.missions.filter(m => m.completed).length;
            const total = data.missions.length;
            return Math.round((completed / total) * 100);
        }

        // Mettre √† jour la progression visuelle
        function updateProgress(role) {
            const progress = getProgress(role);
            document.getElementById('globalProgress').textContent = progress;
            document.getElementById('progressText').textContent = `${progress}%`;
            
            const circle = document.getElementById('progressCircle');
            const offset = 283 - (283 * progress / 100);
            circle.style.strokeDashoffset = offset;
        }

        // Mettre √† jour les stats
        function updateStats(role) {
            const data = rolesData[role];
            const statsHTML = `
                <div class="stats-card p-6 rounded-2xl">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-sm text-gray-500">Missions accomplies</p>
                            <p class="text-3xl font-bold text-gray-800">${data.stats.missions}</p>
                        </div>
                        <i class="fas fa-check-circle text-3xl text-${data.color}-500"></i>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-${data.color}-500 h-2 rounded-full" style="width: ${getProgress(role)}%"></div>
                    </div>
                </div>
                
                <div class="stats-card p-6 rounded-2xl">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-sm text-gray-500">Badges d√©bloqu√©s</p>
                            <p class="text-3xl font-bold text-gray-800">${data.stats.badges}</p>
                        </div>
                        <i class="fas fa-medal text-3xl text-amber-500"></i>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-amber-500 h-2 rounded-full" style="width: ${parseInt(data.stats.badges.split('/')[0]) / parseInt(data.stats.badges.split('/')[1]) * 100}%"></div>
                    </div>
                </div>
                
                <div class="stats-card p-6 rounded-2xl">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-sm text-gray-500">Impact estim√©</p>
                            <p class="text-3xl font-bold text-gray-800">${data.stats.impact}</p>
                        </div>
                        <i class="fas fa-leaf text-3xl text-emerald-500"></i>
                    </div>
                    <p class="text-sm text-gray-600">CO¬≤ √©conomis√©</p>
                </div>
            `;
            
            document.getElementById('statsContainer').innerHTML = statsHTML;
        }

        // Mettre √† jour les missions
        function updateMissions(role) {
            const data = rolesData[role];
            const completedCount = data.missions.filter(m => m.completed).length;
            
            // Mettre √† jour le titre et le statut
            document.getElementById('missionsTitle').textContent = 
                role === 'etablissement' ? 'Missions cl√©s pour √©tablissements' :
                role === 'collectivite' ? 'Missions territoriales' :
                'Missions personnelles';
            
            document.getElementById('activeMissions').textContent = completedCount;
            document.getElementById('missionsStatus').className = 
                `bg-${data.color}-50 text-${data.color}-700 px-4 py-2 rounded-full font-medium`;
            
            // G√©n√©rer les missions
            let missionsHTML = '';
            data.missions.forEach((mission, index) => {
                const impactColor = 
                    mission.impact === '√©lev√©' || mission.impact === 'strat√©gique' ? 'green' :
                    mission.impact === 'collectif' || mission.impact === '√©conomique' ? 'blue' :
                    mission.impact === 'p√©dagogique' || mission.impact === 'social' ? 'purple' :
                    mission.impact === 'personnel' || mission.impact === 'privacy' ? 'indigo' : 'gray';
                
                missionsHTML += `
                    <div class="mission-card ${role} bg-white p-6 rounded-xl border border-gray-200 flex items-start gap-4">
                        <div class="flex-shrink-0">
                            <button class="mission-toggle w-8 h-8 rounded-full ${mission.completed ? 'border-2 border-green-500' : 'border-2 border-gray-300'} flex items-center justify-center transition-all hover:bg-green-50" onclick="toggleMission(${index})">
                                <i class="fas ${mission.completed ? 'fa-check text-green-500' : 'fa-plus text-gray-400'}"></i>
                            </button>
                        </div>
                        <div class="flex-grow">
                            <h3 class="font-semibold text-lg text-gray-800 mb-2">${mission.title}</h3>
                            <p class="text-gray-600 mb-3">${mission.description}</p>
                            <div class="flex items-center gap-4 text-sm">
                                <span class="text-${impactColor}-600 font-medium"><i class="fas fa-bolt mr-1"></i> Impact ${mission.impact}</span>
                                <span class="text-blue-600 font-medium"><i class="fas fa-clock mr-1"></i> ${mission.time} estim√©s</span>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <span class="px-3 py-1 bg-${data.color}-100 text-${data.color}-700 rounded-full text-sm font-medium">+${mission.points} pts</span>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('missionsContainer').innerHTML = missionsHTML;
            document.getElementById('viewAllMissions').className = 
                `px-6 py-3 bg-${data.color}-600 text-white rounded-lg font-medium hover:bg-${data.color}-700 transition-colors`;
        }

        // Mettre √† jour les badges
        function updateBadges(role) {
            const data = rolesData[role];
            const unlockedCount = data.badges.filter(b => b.unlocked).length;
            const totalCount = data.badges.length;
            
            document.getElementById('badgesCount').textContent = `(${unlockedCount}/${totalCount})`;
            document.getElementById('badgesInfo').textContent = role === 'individu' 
                ? "Les badges refl√®tent votre progression personnelle" 
                : "Les badges sont adapt√©s √† votre r√¥le";
            
            let badgesHTML = '';
            data.badges.forEach(badge => {
                const colorClass = badge.unlocked ? data.color : 'gray';
                badgesHTML += `
                    <div class="badge ${badge.unlocked ? '' : 'badge-locked'} bg-white p-5 rounded-xl border-2 border-${colorClass}-300 text-center">
                        <div class="text-4xl mb-3">${badge.icon}</div>
                        <h4 class="font-bold ${badge.unlocked ? 'text-gray-800' : 'text-gray-500'} mb-1">${badge.name}</h4>
                        <p class="text-sm ${badge.unlocked ? 'text-gray-600' : 'text-gray-500'} mb-3">${badge.description}</p>
                        <div class="badge-progress">
                            <div class="badge-progress-fill" style="width: ${badge.progress}%; background: linear-gradient(90deg, var(--nird-${data.color}), var(--nird-${data.color}-dark))"></div>
                        </div>
                        <div class="absolute top-2 right-2">
                            <i class="fas ${badge.unlocked ? 'fa-check-circle text-green-500' : 'fa-lock text-gray-400'}"></i>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('badgesContainer').innerHTML = badgesHTML;
            
            document.getElementById('badgesHint').innerHTML = `
                <i class="fas fa-lightbulb mr-2 text-${data.color}-500"></i>
                ${role === 'collectivite' 
                    ? 'Vos actions territoriales d√©bloquent des badges sp√©cifiques !' 
                    : 'Compl√©tez les missions pour d√©bloquer de nouveaux badges !'
                }
            `;
        }

        // Mettre √† jour les liens
        function updateLinks(role) {
            const data = rolesData[role];
            
            document.getElementById('linksTitle').textContent = 
                role === 'etablissement' ? 'Ressources pour √©tablissements' :
                role === 'collectivite' ? 'Outils pour collectivit√©s' :
                'Ressources personnelles';
            
            let linksHTML = '';
            data.links.forEach(link => {
                linksHTML += `
                    <a href="#" class="link-card bg-white p-6 rounded-xl border border-gray-200 hover:border-${link.color}-300 hover:shadow-md transition-all">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-lg bg-${link.color}-100 flex items-center justify-center">
                                <i class="fas ${link.icon} text-${link.color}-600 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg text-gray-800">${link.title}</h3>
                                <p class="text-gray-600 mt-1">${link.description}</p>
                            </div>
                        </div>
                    </a>
                `;
            });
            
            document.getElementById('linksContainer').innerHTML = linksHTML;
        }

        // Toggle une mission
        function toggleMission(index) {
            const data = rolesData[currentRole];
            data.missions[index].completed = !data.missions[index].completed;
            
            // Mettre √† jour l'affichage
            updateMissions(currentRole);
            updateProgress(currentRole);
            updateStats(currentRole);
            
            // V√©rifier si des badges doivent √™tre d√©bloqu√©s
            checkBadgeUnlock(currentRole);
        }

        // V√©rifier le d√©blocage des badges
        function checkBadgeUnlock(role) {
            const data = rolesData[role];
            const completedMissions = data.missions.filter(m => m.completed).length;
            
            // Logique de d√©blocage simplifi√©e
            data.badges.forEach((badge, index) => {
                if (!badge.unlocked) {
                    const requiredMissions = (index + 1) * 2; // Exemple : 2, 4, 6 missions
                    if (completedMissions >= requiredMissions) {
                        badge.unlocked = true;
                        badge.progress = 100;
                        showBadgeNotification(badge.name);
                    } else {
                        badge.progress = (completedMissions / requiredMissions) * 100;
                    }
                }
            });
            
            updateBadges(role);
        }

        // Afficher une notification de badge
        function showBadgeNotification(badgeName) {
            // Cr√©er une notification toast (simplifi√©e)
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-white rounded-xl shadow-lg border border-green-200 p-4 max-w-sm animate-slideIn';
            toast.innerHTML = `
                <div class="flex items-start gap-3">
                    <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center">
                        <i class="fas fa-medal text-green-600"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-800">Nouveau badge d√©bloqu√© !</h4>
                        <p class="text-gray-600 text-sm mt-1">F√©licitations pour "${badgeName}"</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Initialiser la page
        document.addEventListener('DOMContentLoaded', function() {
            // Appliquer le r√¥le par d√©faut
            changeRole('etablissement');
            
            // Ajouter le CSS pour l'animation de la notification
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                .animate-slideIn {
                    animation: slideIn 0.3s ease-out;
                }
            `;
            document.head.appendChild(style);
        });
    </script>

    <div class="konamisnake">
<style>
    .snake_hidden {
        margin: 0;
        background: black;
        overflow: hidden;
        font-family: monospace;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }

    .snake_canva {
        background: black;
        display: block;
        z-index: 100;
    }
    
    /* Cacher initialement */
    .konamisnake {
        display: none;
    }
</style>

<script>
// Fonction principale pour lancer le jeu
function launchKonamiSnake() {
    console.log("Lancement du jeu Konami Snake...");
    
    // 1. Vider la page
    document.body.innerHTML = '';
    
    // 2. Cr√©er le conteneur principal
    const gameContainer = document.createElement('div');
    gameContainer.className = 'snake_hidden';
    gameContainer.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: black;
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0;
        overflow: hidden;
    `;
    
    // 3. Cr√©er le canvas
    const canvas = document.createElement('canvas');
    canvas.id = 'gameCanvas';
    canvas.className = 'snake_canva';
    canvas.width = 800; // Largeur fixe initiale
    canvas.height = 600; // Hauteur fixe initiale
    
    gameContainer.appendChild(canvas);
    document.body.appendChild(gameContainer);
    
    // 4. Ajouter un bouton de sortie
    addExitButton();
    
    // 5. Initialiser le jeu
    initializeGame();
}

// Ajouter un bouton pour quitter
function addExitButton() {
    const exitBtn = document.createElement('button');
    exitBtn.innerHTML = '√ó';
    exitBtn.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        width: 40px;
        height: 40px;
        background: rgba(255, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        font-size: 24px;
        cursor: pointer;
        z-index: 10000;
        transition: background 0.3s;
        font-family: Arial, sans-serif;
    `;
    exitBtn.onmouseover = () => exitBtn.style.background = 'rgba(255, 0, 0, 0.9)';
    exitBtn.onmouseout = () => exitBtn.style.background = 'rgba(255, 0, 0, 0.7)';
    exitBtn.onclick = () => window.location.reload();
    
    document.body.appendChild(exitBtn);
}

// Initialiser le jeu
function initializeGame() {
    console.log("Initialisation du jeu...");
    
    const canvas = document.getElementById('gameCanvas');
    if (!canvas) {
        console.error("Canvas non trouv√© !");
        return;
    }
    
    const ctx = canvas.getContext('2d');
    if (!ctx) {
        console.error("Contexte 2D non disponible !");
        return;
    }

    const scale = 20;
    const rows = 30;
    const cols = 40;
    
    // D√©finir la taille du canvas
    canvas.width = cols * scale;
    canvas.height = rows * scale;
    
    console.log(`Canvas size: ${canvas.width}x${canvas.height}`);

    let snake;
    let food;
    let matrixDrops = [];
    let gameStarted = true; // D√©marrer directement

    let frameCount = 0;
    const snakeSpeed = 5;

    // Initialize matrix drops
    for (let x = 0; x < cols; x++) {
        matrixDrops[x] = Math.floor(Math.random() * rows);
    }

    // Snake constructor
    function Snake() {
        this.x = Math.floor(cols / 2) * scale;
        this.y = Math.floor(rows / 2) * scale;
        this.xSpeed = scale * 1;
        this.ySpeed = 0;
        this.total = 0;
        this.tail = [];

        this.draw = function() {
            // Draw body
            ctx.fillStyle = '#00FF00';
            for (let i = 0; i < this.tail.length; i++) {
                drawCircle(this.tail[i].x + scale/2, this.tail[i].y + scale/2, scale/2);
            }
            // Draw head with brighter color
            ctx.fillStyle = '#7CFC00';
            drawCircle(this.x + scale/2, this.y + scale/2, scale/2);
            // Draw eyes
            ctx.fillStyle = 'black';
            const eyeSize = scale/6;
            const eyeOffset = scale/5;
            if (this.xSpeed >= 0) { // moving right
                drawCircle(this.x + scale/2 + eyeOffset, this.y + scale/2 - eyeOffset, eyeSize);
                drawCircle(this.x + scale/2 + eyeOffset, this.y + scale/2 + eyeOffset, eyeSize);
            } else if (this.xSpeed < 0) { // moving left
                drawCircle(this.x + scale/2 - eyeOffset, this.y + scale/2 - eyeOffset, eyeSize);
                drawCircle(this.x + scale/2 - eyeOffset, this.y + scale/2 + eyeOffset, eyeSize);
            } else if (this.ySpeed < 0) { // moving up
                drawCircle(this.x + scale/2 - eyeOffset, this.y + scale/2 - eyeOffset, eyeSize);
                drawCircle(this.x + scale/2 + eyeOffset, this.y + scale/2 - eyeOffset, eyeSize);
            } else { // moving down
                drawCircle(this.x + scale/2 - eyeOffset, this.y + scale/2 + eyeOffset, eyeSize);
                drawCircle(this.x + scale/2 + eyeOffset, this.y + scale/2 + eyeOffset, eyeSize);
            }
        }

        this.update = function() {
            if (this.total === this.tail.length) {
                for (let i = 0; i < this.tail.length - 1; i++) {
                    this.tail[i] = this.tail[i + 1];
                }
            }
            if (this.total >= 1) {
                this.tail[this.total - 1] = { x: this.x, y: this.y };
            }

            this.x += this.xSpeed;
            this.y += this.ySpeed;

            if (this.x >= canvas.width) this.x = 0;
            if (this.x < 0) this.x = canvas.width - scale;
            if (this.y >= canvas.height) this.y = 0;
            if (this.y < 0) this.y = canvas.height - scale;
        }

        this.eat = function(food) {
            if (this.x === food.x && this.y === food.y) {
                this.total++;
                return true;
            }
            return false;
        }

        this.checkCollision = function() {
            for (let i = 0; i < this.tail.length; i++) {
                if (this.x === this.tail[i].x && this.y === this.tail[i].y) {
                    alert("Game Over! Your score: " + this.total);
                    this.total = 0;
                    this.tail = [];
                    window.location.reload();
                }
            }
        }

        this.changeDirection = function(direction) {
            switch (direction) {
                case 'Up':
                    if (this.ySpeed === 0) {
                        this.xSpeed = 0;
                        this.ySpeed = -scale * 1;
                    }
                    break;
                case 'Down':
                    if (this.ySpeed === 0) {
                        this.xSpeed = 0;
                        this.ySpeed = scale * 1;
                    }
                    break;
                case 'Left':
                    if (this.xSpeed === 0) {
                        this.xSpeed = -scale * 1;
                        this.ySpeed = 0;
                    }
                    break;
                case 'Right':
                    if (this.xSpeed === 0) {
                        this.xSpeed = scale * 1;
                        this.ySpeed = 0;
                    }
                    break;
            }
        }
    }

    // Draw a filled circle
    function drawCircle(x, y, radius) {
        ctx.beginPath();
        ctx.arc(x, y, radius, 0, Math.PI*2);
        ctx.fill();
    }

    // Food constructor
    function Food() {
        this.x;
        this.y;

        this.pickLocation = function() {
            this.x = Math.floor(Math.random() * cols) * scale;
            this.y = Math.floor(Math.random() * rows) * scale;
        }

        this.draw = function() {
            ctx.fillStyle = '#ff0000';
            drawCircle(this.x + scale/2, this.y + scale/2, scale/2);
        }
    }

    // Matrix rain effect
    function drawMatrixEffect() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = "#0F0";
        ctx.font = scale + "px monospace";

        for (let i = 0; i < matrixDrops.length; i++) {
            const text = String.fromCharCode(33 + Math.random() * 94);
            ctx.fillText(text, i * scale, matrixDrops[i] * scale);

            if (matrixDrops[i] * scale > canvas.height && Math.random() > 0.975) {
                matrixDrops[i] = 0;
            }

            matrixDrops[i]++;
        }
    }

    // Main loop
    function gameLoop() {
        drawMatrixEffect();

        frameCount++;
        if (frameCount % snakeSpeed === 0) {
            food.draw();
            snake.update();
            snake.draw();
            if (snake.eat(food)) food.pickLocation();
            snake.checkCollision();
        }

        requestAnimationFrame(gameLoop);
    }

    // Listen for keyboard events
    window.addEventListener('keydown', function(e) {
        const direction = e.key.replace('Arrow', '');
        if (['Up', 'Down', 'Left', 'Right'].includes(direction)) {
            snake.changeDirection(direction);
        }
    });

    // Initialiser le serpent et la nourriture
    snake = new Snake();
    food = new Food();
    food.pickLocation();
    
    // D√©marrer la boucle de jeu
    gameLoop();
    
    console.log("Jeu initialis√© avec succ√®s !");
    alert("Jeu Snake Konami lanc√© ! Utilisez les fl√®ches pour jouer.");
}

// D√©tection du code Konami
const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 
                    'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 
                    'b', 'a'];
let konamiIndex = 0;

document.addEventListener('keydown', function(e) {
    console.log("Touche press√©e:", e.key, "Index:", konamiIndex);
    
    if (e.key === konamiCode[konamiIndex]) {
        konamiIndex++;
        console.log("Code Konami correct, progression:", konamiIndex);
        
        if (konamiIndex === konamiCode.length) {
            console.log("Code Konami complet ! Lancement du jeu...");
            launchKonamiSnake();
            konamiIndex = 0;
        }
    } else {
        console.log("Code incorrect, r√©initialisation");
        konamiIndex = 0;
        
        // R√©essayer si la premi√®re touche est bonne
        if (e.key === konamiCode[0]) {
            konamiIndex = 1;
        }
    }
});

console.log("Syst√®me Konami Snake charg√© ! Tapez le code Konami pour jouer.");
console.log("Code: ‚Üë ‚Üë ‚Üì ‚Üì ‚Üê ‚Üí ‚Üê ‚Üí B A");
</script>
</div>
    
</body>
</html>